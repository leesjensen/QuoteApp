<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quotes â€¢ CS260</title>
  <meta name="description" content="A tiny modern app that fetches and displays a random quote." />
  <style>
    :root {
      --bg: #0b1020;
      --card: rgba(255,255,255,0.06);
      --text: #e7eaf3;
      --muted: #9aa4bf;
      --accent: #7aa2ff;
      --accent-contrast: #0b1020;
      --ring: rgba(122,162,255,0.5);
      --shadow: 0 10px 40px rgba(0,0,0,0.35), inset 0 1px 1px rgba(255,255,255,0.06);
    }

    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f6f7fb;
        --card: rgba(255,255,255,0.8);
        --text: #0b1020;
        --muted: #5b6378;
        --accent: #345dff;
        --accent-contrast: #ffffff;
        --ring: rgba(52,93,255,0.35);
        --shadow: 0 10px 40px rgba(0,0,0,0.08);
      }
    }

    html, body {
      height: 100%;
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 10% 10%, rgba(122,162,255,0.08), transparent 40%),
                  radial-gradient(1200px 800px at 90% 90%, rgba(255,122,162,0.08), transparent 40%),
                  var(--bg);
      color: var(--text);
    }

    .app {
      min-height: 100svh;
      display: grid;
      place-items: center;
      padding: clamp(16px, 4vw, 40px);
    }

    .card {
      width: 100%;
      max-width: min(75vw, 70ch); /* text fits 75% of the viewport width, with comfortable line length */
      background: var(--card);
      backdrop-filter: blur(10px) saturate(120%);
      -webkit-backdrop-filter: blur(10px) saturate(120%);
      border-radius: 20px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,0.12);
      padding: clamp(20px, 4vw, 36px);
      display: grid;
      gap: 18px;
    }

    h1 {
      margin: 0;
      font-size: clamp(20px, 2.6vw, 28px);
      font-weight: 700;
      letter-spacing: 0.2px;
      text-align: center;
    }

    .sub {
      margin: 0;
      color: var(--muted);
      font-size: clamp(12px, 1.6vw, 14px);
      text-align: center;
    }

    .quote {
      margin: 8px 0 0;
      font-size: clamp(18px, 2.5vw, 26px);
      line-height: 1.4;
      text-wrap: balance;
      text-align: center;
      /* ensure the text area itself also scales to 75% of the viewport width */
      width: 75vw;
      max-width: 70ch;
      justify-self: center;
    }

    .controls {
      display: grid;
      place-items: center;
      gap: 10px;
      margin-top: 8px;
    }

    button {
      appearance: none;
      border: none;
      outline: none;
      padding: 12px 18px;
      border-radius: 999px;
      background: var(--accent);
      color: var(--accent-contrast);
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      transition: transform .06s ease, box-shadow .15s ease;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    }

    button:hover { transform: translateY(-1px); }
    button:active { transform: translateY(0); }

    button:focus-visible {
      box-shadow: 0 0 0 4px var(--ring);
    }

    button[disabled] {
      opacity: 0.65;
      cursor: not-allowed;
    }

    .status {
      height: 20px;
      font-size: 13px;
      color: var(--muted);
      text-align: center;
      min-height: 1em;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .spinner {
      width: 16px; height: 16px;
      border-radius: 50%;
      border: 2px solid currentColor;
      border-top-color: transparent;
      display: inline-block;
      animation: spin .8s linear infinite;
      vertical-align: text-bottom;
      margin-left: 8px;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    footer {
      text-align: center;
      color: var(--muted);
      font-size: 12px;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <main class="app">
    <section class="card" role="region" aria-labelledby="app-title">
      <header>
        <h1 id="app-title">Random Quote</h1>
        <p class="sub">Click the button to fetch a fresh line of wisdom.</p>
      </header>

      <blockquote id="quote" class="quote" aria-live="polite" aria-atomic="true">&nbsp;</blockquote>

      <div class="controls">
        <button id="btn" type="button" aria-describedby="hint">
          Get Quote
        </button>
        <p id="hint" class="status" aria-live="polite"></p>
      </div>

      <footer>
        <small>Source: <code>https://quote.cs260.click</code></small>
      </footer>
    </section>
  </main>

  <script>
    (function () {
      const btn = document.getElementById('btn');
      const quoteEl = document.getElementById('quote');
      const hint = document.getElementById('hint');

      async function fetchWithTimeout(resource, options = {}) {
        const { timeout = 10000 } = options; // 10s
        const controller = new AbortController();
        const id = setTimeout(() => controller.abort(), timeout);
        try {
          const response = await fetch(resource, { ...options, signal: controller.signal, cache: 'no-store' });
          return response;
        } finally {
          clearTimeout(id);
        }
      }

      function setLoading(isLoading) {
        btn.disabled = isLoading;
        if (isLoading) {
          btn.setAttribute('aria-busy', 'true');
          hint.innerHTML = 'Fetching quote <span class="spinner" aria-hidden="true"></span>';
        } else {
          btn.removeAttribute('aria-busy');
          hint.textContent = '';
        }
      }

      async function getQuote() {
        setLoading(true);
        try {
          const res = await fetchWithTimeout('https://quote.cs260.click', { timeout: 10000 });

          if (!res.ok) {
            throw new Error(`Server responded with ${res.status}`);
          }

          // The endpoint returns plain text; fall back to text even if content-type is odd.
          const json = await res.json();
          quoteEl.textContent = json.quote || 'No quote received. Try again?';
        } catch (err) {
          console.error(err);
          quoteEl.textContent = 'Couldn\'t fetch a quote just now.';
          hint.textContent = 'Check your connection and try again.';
        } finally {
          setLoading(false);
        }
      }

      // First load: pull a quote automatically for a snappier UX
      getQuote();

      // Button click to fetch another
      btn.addEventListener('click', getQuote);

      // Refresh typography a bit on resize/orientation change (no heavy work)
      let resizeTimer;
      addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
          // Trigger a reflow-friendly tweak if needed later.
        }, 120);
      });
    })();
  </script>
</body>
</html>
